<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.53">


<title data-react-helmet="true">TCP | My Site</title>

<meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="TCP | My Site"><meta data-react-helmet="true" name="description" content="## Content"><meta data-react-helmet="true" property="og:description" content="## Content"><meta data-react-helmet="true" property="og:url" content="https://Wiznet.github.io/docs/Product/iEthernet/W5100S/Application Note/tcp">

<link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico">


<link rel="stylesheet" href="/styles.6da835b6.css">


<link rel="preload" href="/styles.fe9632ff.js" as="script">

<link rel="preload" href="/runtime~main.1aae1744.js" as="script">

<link rel="preload" href="/main.8be1d49d.js" as="script">

<link rel="preload" href="/1.c2b11969.js" as="script">

<link rel="preload" href="/2.08249d2f.js" as="script">

<link rel="preload" href="/3.30edc262.js" as="script">

<link rel="preload" href="/1be78505.a940f782.js" as="script">

<link rel="preload" href="/20ac7829.bee19571.js" as="script">

<link rel="preload" href="/17896441.75384c65.js" as="script">

<link rel="preload" href="/80a3db3f.22f01d85.js" as="script">

</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/wiznet-logo.svg" alt="My Site Logo"><strong class="navbar__title"></strong></a><a class="navbar__item navbar__link" href="/docs/introduction">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a target="_blank" rel="noopener noreferrer" href="https://github.com/facebook/docusaurus" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/wiznet-logo.svg" alt="My Site Logo"><strong class="navbar__title"></strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" position="left" href="/docs/introduction">Docs</a></li><li class="menu__list-item"><a class="menu__link" position="left" href="/blog">Blog</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="https://github.com/facebook/docusaurus" class="menu__link" position="right">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">WIZnet Document Wiki</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/introduction">Introduction</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Products</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/products">Products</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Pre-programmed MCU</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/Pre-programmed MCU/pre_programmed_mcu">Pre-programmed MCU</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">W7500P</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/Pre-programmed MCU/W7500P-S2E/w7500p-s2e-[KO]">W7500(P)-S2E</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/Pre-programmed MCU/W7500P-S2E/w7500p-s2e-[EN]">W7500P-S2E</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">iEthernet</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/iEthernet/iethernet">iEthernet</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">W6100</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W6100/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W6100/document">Document</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W6100/driver_basic_project">Driver &amp; Basic Project</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W6100/ref_schematic">Ref. Schematic</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W6100/application_note">Application Note</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W6100/w6100_evb">W6100-EVB</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">W5100S</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/iEthernet/W5100S/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/iEthernet/W5100S/document">Document</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/iEthernet/W5100S/driver">Driver</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/iEthernet/W5100S/ref_schematic">Ref. Schematic</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/iEthernet/W5100S/comparison_sheet">Comparison Sheet</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Application Note</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" tabindex="0" href="/docs/Product/iEthernet/W5100S/Application Note/tcp">TCP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/iEthernet/W5100S/Application Note/udp">UDP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/iEthernet/W5100S/Application Note/ipraw">IPRAW</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/iEthernet/W5100S/Application Note/pppoe">PPPoE</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/iEthernet/W5100S/Application Note/socket_less_command">SOCKET-less Command</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/iEthernet/W5100S/Application Note/interrupt">Interrupt</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/iEthernet/W5100S/Application Note/dma">DMA</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/iEthernet/W5100S/all_pages">All Pages</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/iEthernet/W5100S/w5100s_evb">W5100S-EVB</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">W5500</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W5500/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W5500/datasheet">Datasheet</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W5500/ref_schematic">Ref. Schematic</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Application</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W5500/Application/tcp">TCP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W5500/Application/udp">UDP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W5500/Application/ipraw">IPRAW</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W5500/Application/pppoe">PPPoE</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W5500/Application/spi_performance">SPI Performance</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W5500/esd_test_document">ESD Test Document</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W5500/all_pages">All Pages</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">W5500-EVB</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W5500/W5500-EVB/w5500_evb">W5500-EVB</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W5500/W5500-EVB/getting_started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W5500/W5500-EVB/make_new_projects">Make New Projects</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link" to="http://www.wiznet.io/product-item/w5300/" target="_blank" rel="noreferrer noopener" tabindex="0" href="http://www.wiznet.io/product-item/w5300/">W5300(Link)</a></li><li class="menu__list-item"><a class="menu__link" to="https://www.wiznet.io/product-item/w5100/" target="_blank" rel="noreferrer noopener" tabindex="0" href="https://www.wiznet.io/product-item/w5100/">W5100(Link)</a></li><li class="menu__list-item"><a class="menu__link" to="https://www.wiznet.io/product-item/w3150a+/" target="_blank" rel="noreferrer noopener" tabindex="0" href="https://www.wiznet.io/product-item/w3150a+/">W3150A+(Link)</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">ioModule</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/iomodule">ioModule</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">WIZ610io</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/WIZ610io/wiz610io">WIZ610io</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">WIZ610MJ</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/WIZ610MJ/wiz610mj">WIZ610MJ</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">WIZ810Sio</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/WIZ810Sio/wiz810sio">WIZ810Sio</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">WIZ810SMJ</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/WIZ810SMJ/wiz810smj">WIZ810SMJ</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">WIZ850io</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/WIZ850io/wiz850io">WIZ850io</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">WIZ550io</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/WIZ550io/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/WIZ550io/hardware_pins">Hardware Pins</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/WIZ550io/characteristic">Characteristic</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/WIZ550io/spi_operations">SPI Operations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/WIZ550io/timing_diagram">Timing Diagram</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/WIZ550io/block_diagram_schematic">Block Diagram &amp; Schematic</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/WIZ550io/dimension">Dimension</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/WIZ550io/related_products">Related Products</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/WIZ550io/all_pages">All Pages</a></li></ul></li><li class="menu__list-item"><a class="menu__link" to="http://www.wiznet.io/product-item/wiz820io/" target="_blank" rel="noreferrer noopener" tabindex="-1" href="http://www.wiznet.io/product-item/wiz820io/">WIZ820io(Link)</a></li><li class="menu__list-item"><a class="menu__link" to="https://www.wiznet.io/product-item/wiz810mj/" target="_blank" rel="noreferrer noopener" tabindex="-1" href="https://www.wiznet.io/product-item/wiz810mj/">WIZ810MJ(Link)</a></li><li class="menu__list-item"><a class="menu__link" to="https://www.wiznet.io/product-item/wiz811mj/" target="_blank" rel="noreferrer noopener" tabindex="-1" href="https://www.wiznet.io/product-item/wiz811mj/">WIZ811MJ(Link)</a></li><li class="menu__list-item"><a class="menu__link" to="http://www.wiznet.io/product-item/wiz812mj/" target="_blank" rel="noreferrer noopener" tabindex="-1" href="http://www.wiznet.io/product-item/wiz812mj/">WIZ812MJ(Link)</a></li><li class="menu__list-item"><a class="menu__link" to="https://www.wiznet.io/product-item/wiz830mj/" target="_blank" rel="noreferrer noopener" tabindex="-1" href="https://www.wiznet.io/product-item/wiz830mj/">WIZ830MJ(Link)</a></li><li class="menu__list-item"><a class="menu__link" to="https://www.wiznet.io/product-item/nm7010b+/" target="_blank" rel="noreferrer noopener" tabindex="-1" href="https://www.wiznet.io/product-item/nm7010b+/">NM7010B+(Link)</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">App Module</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/App Module/app_module">App Module</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">WIZ550web</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/App Module/WIZ550web/wiz550web">WIZ550web</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/App Module/WIZ550web/datasheet_kor">Datasheet(Kor)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/App Module/WIZ550web/datasheet_eng">Datasheet(Eng)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/App Module/WIZ550web/getting_started_guide_kor">Getting Started Guide(Kor)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/App Module/WIZ550web/getting_started_guide_eng">Getting Started Guide(Eng)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/App Module/WIZ550web/future_plan_kor">Future Plan(Kor)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/App Module/WIZ550web/future_plan_eng">Future Plan(Eng)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/App Module/WIZ550web/tutorials_kor">Tutorials(Kor)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/App Module/WIZ550web/tutorials_eng">Tutorials(Eng)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/App Module/WIZ550web/download">Download</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Open Source Hardware</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/Open Source Hardware/open_source_hardware">Open Source Hardware</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/Open Source Hardware/w5100s_mkr_ethernet_shield">W5100S (MKR-)Ethernet Shield</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/Open Source Hardware/w6100_mkr_ethernet_shield">W6100 (MKR-)Ethernet Shield</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/Open Source Hardware/wizarduino_m0_eth">WizArduino M0 ETH</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/Open Source Hardware/wizarduino_mega_wifi">WizArduino MEGA WIFI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/Open Source Hardware/wizfi310_shield">WizFi310 Shield</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/Open Source Hardware/w5500_ethernet_shield">W5500 Ethernet Shield</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/Open Source Hardware/ioshield_a">ioShield-A</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/Open Source Hardware/ioshield_k">ioShield-K</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/Open Source Hardware/ioshield_l">ioShield-L</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Design_Guide</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Design Guide/design_guide">Design Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Design Guide/hardware_design_guide">Hardware Design Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Design Guide/package_information">Package Information</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Design Guide/ir_reflow_profile">IR Reflow Profile</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Design Guide/eagle_cad_library_of_wiznet_products">Eagle CAD Library of WIZnet Products</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">VAR_Products_using_WIZnet</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/VAR Products using WIZnet/ethernet_shield">Ethernet Shield</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/VAR Products using WIZnet/wi_fi_shield">Wi-Fi Shield</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/VAR Products using WIZnet/third_party">Third party</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="container padding-vert--lg docItemWrapper_1cc7"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">TCP</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="content"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#content" title="Direct link to heading">#</a>Content</h2><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="w5100s-tcp-function"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#w5100s-tcp-function" title="Direct link to heading">#</a>W5100S TCP Function</h1><p>By setting some Registers and Memory Operation, W5100S provides Internet
Connectivity. This Chapter describes How to operate W5100S TCP Function.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="initialization"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#initialization" title="Direct link to heading">#</a>Initialization</h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="basic-setting"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#basic-setting" title="Direct link to heading">#</a>Basic Setting</h3><p>For W5100S Operation, select and utilize appropriate Registers shown
below.</p><ol><li>Mode Register (MR)</li><li>Interrupt Mask Register (IMR)</li><li>Retry Time-value Register (RTR)</li><li>Retry Count Register (RCR)</li></ol><p>For more Information of above Registers, refer to the “Register
Descriptions” in <a href="/products/w5100s/datasheet">W5100S Datasheet</a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="setting-network-information"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#setting-network-information" title="Direct link to heading">#</a>Setting Network Information</h3><p>Basic Network Information setting for Communication: It must be set the
basic Network Information.</p><ol><li>SHAR(Source Hardware Address Register)<ul><li>It is prescribed that the Source Hardware Addresses, which is
set by SHAR, use unique Hardware Addresses (Ethernet MAC
address) in the Ethernet MAC Layer. The IEEE manages the MAC
address allocation. The manufacturer which produces the Network
device allocates the MAC Address to product.</li><li>Details on MAC address allocation refer to the website as below.</li><li><a href="http://www.ieee.org/">http://www.ieee.org/</a></li><li><a href="http://standards.ieee.org/regauth/oui/index.shtml">http://standards.ieee.org/regauth/oui/index.shtml</a></li></ul></li><li>GAR(Gateway Address Register)</li><li>SUBR(Subnet Mask Register)</li><li>SIPR(Source IP Address Register)</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="set-socket-n-buffer-information"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#set-socket-n-buffer-information" title="Direct link to heading">#</a>Set SOCKET n Buffer Information</h3><p>This stage shows SOCKET n TX/RX Buffer Information. The base Address and
Mask Address of each SOCKET are set in this stage.</p><div>*In case of, assign 2KB TX/RX Buffer per SOCKET*</div><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">In </span><span class="token keyword" style="font-style:italic">case</span><span class="token plain"> of</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> assign </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain">KB TX</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">RX Buffer per SOCKET</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// set Base Address of TX/RX Buffer for SOCKET n</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   gS0_RX_BASE </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x8000</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// TX Buffer Block Base Address</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   gS0_RX_BASE </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0xC000</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// RX Buffer Block Base Address</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   TxTotalSize </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// For check the total size of SOCKET n TX Buffer</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   RxTotalSize </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// For check the total size of SOCKET n RX Buffer</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">n</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> n</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> n</span><span class="token operator" style="color:rgb(137, 221, 255)">++</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Sn_TXBUF_SIZE </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// assign 2KB TX Buffer per SOCKET</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Sn_RXBUF_SIZE </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// assign 2KB RX Buffer per SOCKET</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 0x07FF, for getting offset address within assigned SOCKET n TX/RX Buffer</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      gSn_TX_MASK </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1024</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> Sn_TXBUF_SIZE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> – </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      gSn_RX_MASK </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1024</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> Sn_RXBUF_SIZE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">if</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"> n </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         gSn_TX_BASE </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> gSn</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">_TX_BASE </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1024</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> Sn</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">_TXBUF_SIZE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         gSn_RX_BASE </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> gSn</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">_RX_BASE </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1024</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> Sn</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">_RXBUF_SIZE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// end if</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   TxTotalSize </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> TxTotalSize </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> Sn_TXBUF_SIZE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   RxTotalSize </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> RxTotalSize </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> Sn_RXBUF_SIZE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token function" style="color:rgb(130, 170, 255)">If</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"> TxTotalSize </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">8</span><span class="token plain"> or RxTotalSize </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">8</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> ERROR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// invalid Total Size</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// end for</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="data-communications"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#data-communications" title="Direct link to heading">#</a>Data Communications</h2><p>After Initialization Process, SOCKET is opened on TCP, UDP, IPRAW or
MACRAW Mode and able to transmit and receive Data. This stage shows How
to use SOCKET on TCP Mode.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="tcp"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#tcp" title="Direct link to heading">#</a>TCP</h3><p>TCP (Transmission Control Protocol) is a bidirectional Data Transmission
Protocol based on a 1:1 communication on Transport Layer. It also
provides Communication between Applications by using Port Number. TCP
1:1 communication needs the Connection Process such as transmitting
Connection Request to Peer or receiving Connection Request from Peer. In
this Connection Process, the side transmitting Connection Request is
‘TCP CLIENT’ and the other side receiving Connection Request is ‘TCP
SERVER’. TCP also provides reliable, ordered and error-checked delivery
of a stream Data between applications running on hosts communicating by
an IP network. ‘TCP SERVER’ and ‘TCP CLIENT’ are maintaining transmit
and receive Data until the TCP connection is terminated. <img src="/products/w5500/application/serverclient.jpg" alt="TCP SERVER
and TCP CLIENT"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="tcp-server"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#tcp-server" title="Direct link to heading">#</a>TCP SERVER</h3><p><img src="/products/w5500/application/server_flow.jpg" alt="TCP SERVER Operation
Flow"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="socket-initialization"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#socket-initialization" title="Direct link to heading">#</a>SOCKET Initialization</h4><p>SOCKET Initialization is required for TCP Mode SOCKET. The
Initialization consists of SOCKET Mode setting, SOCKET Port Number
setting, SOCKET Option setting and SOCKET OPEN Command. 4 SOCKETs are
all opened as TCP Mode. After OPEN Command(Sn_CR = OPEN), if the SOCKET
status(Sn_SR) is changed to SOCKET_INIT, SOCKET Initialization is
completed. This process is identically applied in &quot;TCP SERVER&quot; and &quot;TCP
CLIENT&quot;.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">START</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   Sn_MR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;0001&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// set TCP Mode</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   Sn_PORTR0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> source_port</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// sets source port number</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* configure SOCKET Option when you need it */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Sn_MR[ND] = &#x27;1&#x27;; // set No Delay ACK</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   Sn_CR </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> OPEN</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// sets OPEN command</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* wait until Sn_SR is changed to SOCK_INIT */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_SR </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> SOCK_INIT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> Sn_CR </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> CLOSE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> START</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="listen"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#listen" title="Direct link to heading">#</a>LISTEN</h4><p>Run as “TCP SERVER” by LISTEN Command.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* listen SOCKET */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   Sn_CR </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> LISTEN</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* wait until Sn_SR is changed to SOCK_LISTEN */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_SR </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> SOCK_LISTEN</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> Sn_CR </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> CLOSE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> START</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="establishment"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#establishment" title="Direct link to heading">#</a>ESTABLISHMENT</h4><p>&quot;TCP SERVER&quot; keeps Sn_SR (SOCK_LISTEN) until received SYN Packet. If
&quot;TCP SERVER&quot; receives SYN Packet from &quot;TCP CLIENT&quot;, it transmits SYN/ACK
Packet to ‘TCP CLIENT’ and the Connection Process between &quot;TCP SERVER&quot;
and &quot;TCP CLIENT&quot; is completed. If there is no response from Peer against
of transmitted SYN Packet or SYN/ACK Packet within the Retransmission
Time, Sn_IR [TIMEOUT] is set to ‘1’.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">First method </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* check SOCKET Interrupt */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">CON</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* clear SOCKET Interrupt */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">CON</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> Received DATA</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* or goto Send DATA?; */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">else</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">if</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">TIMEOUT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> Timeout</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Second method </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_SR </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> SOCK_ESTABLISHED</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* clear SOCKET Interrupt */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">CON</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> Received DATA</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* or goto Send DATA?; */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">else</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">if</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">TIMEOUT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> Timeout</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="receive-data"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#receive-data" title="Direct link to heading">#</a>Receive DATA?</h4><p>Whether SOCKET n Data is received is confirmed by Sn_IR [RECV] or
Sn_RX_RSR.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">First method </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* check SOCKET RX Memory Received Size */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_RX_RSR </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> Receiving Process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Second method </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">RECV</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* check SOCKET Interrupt */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">RECV</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* clear SOCKET Interrupt */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> Receiving Process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="listen-1"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#listen-1" title="Direct link to heading">#</a>LISTEN</h4><p>Run as “TCP SERVER” by LISTEN Command.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* listen SOCKET */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   Sn_CR </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> LISTEN</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* wait until Sn_SR is changed to SOCK_LISTEN */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_SR </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> SOCK_LISTEN</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> Sn_CR </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> CLOSE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> START</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="establishment-1"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#establishment-1" title="Direct link to heading">#</a>ESTABLISHMENT</h4><p>&quot;TCP SERVER&quot; keeps Sn_SR (SOCK_LISTEN) until received SYN Packet. If
&quot;TCP SERVER&quot; receives SYN Packet from &quot;TCP CLIENT&quot;, it transmits SYN/ACK
Packet to ‘TCP CLIENT’ and the Connection Process between &quot;TCP SERVER&quot;
and &quot;TCP CLIENT&quot; is completed. If there is no response from Peer against
of transmitted SYN Packet or SYN/ACK Packet within the Retransmission
Time, Sn_IR [TIMEOUT] is set to ‘1’.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">First method </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* check SOCKET Interrupt */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">CON</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* clear SOCKET Interrupt */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">CON</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> Received DATA</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* or goto Send DATA?; */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">else</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">if</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">TIMEOUT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> Timeout</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Second method </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_SR </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> SOCK_ESTABLISHED</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* clear SOCKET Interrupt */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">CON</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> Received DATA</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* or goto Send DATA?; */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">else</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">if</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">TIMEOUT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> Timeout</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="receive-data-1"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#receive-data-1" title="Direct link to heading">#</a>Receive DATA?</h4><p>Whether SOCKET n Data is received is confirmed by Sn_IR [RECV] or
Sn_RX_RSR.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">First method </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* check SOCKET RX Memory Received Size */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_RX_RSR </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> Receiving Process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Second method </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">RECV</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* check SOCKET Interrupt */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">RECV</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* clear SOCKET Interrupt */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> Receiving Process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="receiving-process"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#receiving-process" title="Direct link to heading">#</a>Receiving Process</h4><p>Received Data is read from SOCKET n RX Buffer Block. The Read Offset
Address of Received Data in RX Memory Block is calculated by
gSn_RX_BASE, gSn_RX_MASK and Sn_RX_RD. After reading received
Data, Sn_RX_RD must be increased by Data read Size and Sn_CR [RECV]
must be set to ‘1’. If there is remain Data in SOCKET n RX Buffer Block
after Sn_CR [RECV] Command, Sn_IR [RECV] is set to ‘1’. When Read
Offset Address calculated, it is cautious to over the boundary Address
(n=0,1,2 : gSn_RX_BASE ∼ gSn+1_RX_BASE, n=3 : gS3_RX_BASE ∼
0xFFFF) of SOCKET n RX Buffer Block.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* get Received Size */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   get_size </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> Sn_RX_RSR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* calculate SOCKET n RX Buffer Size &amp; Offset Address */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   gSn_RX_MAX </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> Sn_RXBUF_SIZE </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1024</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   get_offset </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> Sn_RX_RD </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain"> gSn_RX_MASK</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* calculate Read Offset Address */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   get_start_address </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> gSn_RX_BASE </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> get_offset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* if overflow the upper boundary of SOCKET n RX Buffer */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token function" style="color:rgb(130, 170, 255)">If</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">get_offset </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> get_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> gSn_RX_MAX </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* copy upper_size bytes of get_start_address to destination_address</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">         - destination_address is user data memory address */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      upper_size </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> gSn_RX_MAX – get_offset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token function" style="color:rgb(130, 170, 255)">memcpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">get_start_address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> destination_address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> upper_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      destination_address </span><span class="token operator" style="color:rgb(137, 221, 255)">+=</span><span class="token plain"> upper_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* copy the remained size bytes of gSn_RX_BASE to destination_address */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      remained_size </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> get_size – upper_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token function" style="color:rgb(130, 170, 255)">memcpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">gSn_RX_BASE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> destination_address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> remained_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">else</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* copy get_size of get_start_address to destination_address */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token function" style="color:rgb(130, 170, 255)">memcpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">get_start_address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> destination_address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> get_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* increase Sn_RX_RD as get_size */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   Sn_RX_RD </span><span class="token operator" style="color:rgb(137, 221, 255)">+=</span><span class="token plain"> get_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* set RECV Command */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   Sn_CR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">RECV</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">while</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_CR </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x00</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* wait until RECV Command is cleared*/</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="send-data--sending-process"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#send-data--sending-process" title="Direct link to heading">#</a>Send DATA? / Sending Process</h4><p>Written Data in SOCKET n TX Buffer Block is transmitted. The Write
Offset Address in TX Memory Block is calculated by gSn_TX_BASE,
gSn_TX_MASK and Sn_TX_WD. And Data to be transmitted from the Write
Offset Address is written. After writing Data, Sn_TX_WD must be
increased by Data Size and Data is transmitted by Sn_CR [SEND].
Before Sn_IR [SENDOK] = ‘1’, next Data Transmission Process is not
executed. After transmitting Data, the time length until
Sn_IR[SENDOK] is depending on SOCKET Count, Data Size and Network
Traffic. Also Sn_IR [TIMEOUT] could be occurred. When Write Offset
Address calculated, it is cautious to over the boundary Address (n=0,1,2
: gSn_TX_BASE ∼ gSn+1_TX_BASE, n=3 : gS3_TX_BASE ∼ 0xC000) of
SOCKET n TX Buffer Block. If there is no response from Peer against of
transmitted Data Packet within the Retransmission Time, Sn_IR
[TIMEOUT] is set to ‘1’.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* calculate SOCKETn TX Buffer Size &amp; Offset Address */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   gSn_TX_MAX </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> Sn_TXBUF_SIZE </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1024</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   get_offset </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> Sn_TX_WR </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain"> gSn_TX_MASK</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* check the max size of DATA(send_size) &amp; Free Size of SOCKETn TX</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">      Buffer(Sn_TX_FSR)*/</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">if</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"> send_size </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">gSn_TX_MAX </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> send_size </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> gSn_TX_MAX</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">while</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">send </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;=</span><span class="token plain"> Sn_TX_FSR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Wait until SOCKET n TX Buffer is free */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* If you don’t want to wait TX Buffer Free</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">      send_size = Sn_TX_FSR; // write Data as size of Free Buffer */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* calculate Write Offset Address */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   get_start_address </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> gSn_TX_BASE </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> get_offset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* if overflow the upper boundary of SOCKET n TX Buffer */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token function" style="color:rgb(130, 170, 255)">If</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">get_offset </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> send_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> gSn_TX_MAX </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* copy upper size bytes of source_address to get_start_address</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">         - source_address is the start address of user data */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      upper_size </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> gSn_TX_MAX – get_offset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token function" style="color:rgb(130, 170, 255)">memcpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">source_address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> get_start_address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> upper_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* copy the Remained Size Bytes of source_address to gSn_TX_BASE */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      source_address </span><span class="token operator" style="color:rgb(137, 221, 255)">+=</span><span class="token plain"> upper_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      remained_size </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> send_size – upper_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token function" style="color:rgb(130, 170, 255)">memcpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">source_address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> gSn_TX_BASE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> remained_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">else</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* copy send_size bytes of source_address to get_start_address</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">         - source_address is the start address of user data */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token function" style="color:rgb(130, 170, 255)">memcpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">source_address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> get_start_address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> send_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* increase Sn_TX_WR as send_size */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   Sn_TX_WR </span><span class="token operator" style="color:rgb(137, 221, 255)">+=</span><span class="token plain"> send_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* set SEND Command */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   Sn_CR </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> SEND</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">while</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_CR </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x00</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* wait until SEND Command is cleared*/</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* wait until SEND Command is completed or TIMEOUT Interrupt is occurred*/</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">while</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">SENDOK</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">’ and Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">TIMEOUT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* clear SOCKET Interrupt*/</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">if</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">SENDOK</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">SENDOK</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">else</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> Timeout</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="received-fin-passive-close"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#received-fin-passive-close" title="Direct link to heading">#</a>Received FIN (Passive Close)</h4><p>When FIN Packet received from Peer.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">First Method</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token function" style="color:rgb(130, 170, 255)">If</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_SR </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> SOCK_CLOSE_WAIT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> Disconnecting Process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Second Method</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token function" style="color:rgb(130, 170, 255)">If</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">DISCON</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> Disconnecting Process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="disconnected-active-close"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#disconnected-active-close" title="Direct link to heading">#</a>Disconnected (Active Close)</h4><p>When FIN Packet transmitted to Peer.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* send FIN Packet */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   Sn_CR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">DISCON</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">while</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_CR </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x00</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* wait until DISCON Command is cleared*/</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> Disconnecting Process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="disconnecting-process"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#disconnecting-process" title="Direct link to heading">#</a>Disconnecting Process</h4><p>In Passive Close, if FIN Packet is received from Peer and there is no
Data to be transmitted, SOCKET transmits FIN Packet and it will be
closed. If there is no response from Peer against of transmitted FIN
Packet within the Retransmission Time, Sn_IR [TIMEOUT] is set to ‘1’.
In Active Close, if SOCKET transmits FIN Packet to Peer, SOCKET waits
for Peer FIN Packet. SOCKET will be closed after receiving FIN Packet
from Peer. If there is no response from Peer against of transmitted FIN
Packet within the Retransmission Time, Sn_IR [TIMEOUT] is set to ‘1’.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Passive Close</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* received FIN Packet from Peer */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* send FIN Packet */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   Sn_CR </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> DISCON</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">while</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_CR </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x00</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* wait until DISCON Command is cleared*/</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* wait unit ACK Packet is received*/</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">while</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">DISCON</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">’ and Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">TIMEOUT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">DISCON</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* clear Interrupt */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">DISCON</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> CLOSED</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">else</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> Timeout</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Active Close </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* sent FIN Packet to Peer */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* wait until FIN Packet is received*/</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">while</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">DISCON</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">’ and Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">TIMEOUT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">DISOCN</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* clear Interrupt */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">DISCON</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> CLOSED</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">else</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> Timeout</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="timeout"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#timeout" title="Direct link to heading">#</a>Timeout?</h4><p>If there is no response from Peer against of transmitted SYN or SYN/ACK
or FIN or Data Packet within the Retransmission Time, Sn_IR [TIMEOUT]
is set to ‘1’.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* check TIMEOUT Interrupt */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">if</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">TIMEOUT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* clear Interrupt */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">TIMEOUT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> CLOSE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="close"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#close" title="Direct link to heading">#</a>CLOSE</h4><p>SOCKET n is closed by the Disconnect Process, Sn_IR[TIMEOUT] = &#x27;1&#x27;
and Sn_CR[CLOSE] = &#x27;1&#x27;.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/*wait until SOCKET n is closed*/</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">while</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_SR </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> SOCK_CLOSED</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="tcp-client"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#tcp-client" title="Direct link to heading">#</a>TCP CLIENT</h3><p><img src="/products/w5100s/application/tcp_client_flow.png" alt="TCP CLIENT Operation
Flow"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="open"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#open" title="Direct link to heading">#</a>OPEN</h4><p>It is the same as &quot;TCP SERVER&quot;.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="connect"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#connect" title="Direct link to heading">#</a>CONNECT</h5><p>SOCKET n is operated as &quot;TCP CLIENT&quot; by Sn_CR[CONNECT]. SYN Packet is
transmitted to &quot;TCP SERVER&quot; by Sn_CR[CONNECT].</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* set Destination IP Address, 192.168.0.11 */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   Sn_DIPR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0xC0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0xA8</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x00</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x0B</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* set Destination PORT Number, 5000(0x1388) */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   Sn_DPORTR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token number" style="color:rgb(247, 140, 108)">0x13</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x88</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* set CONNECT Command */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   Sn_CR </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> CONNECT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">while</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_CR </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x00</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* wait until CONNECT Command is cleared*/</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> ESTABLISHED</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="established"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#established" title="Direct link to heading">#</a>ESTABLISHED?</h4><p>&quot;TCP CLIENT&quot; is in Sn_SR (SOCK_SYNSENT) until receiving SYN/ACK Packet
from &quot;TCP SERVER&quot; against of SYN Packet transmitted. If SYN/ACK Packet
is received from ‘TCP SERVER’, the Connection Process between ‘TCP
SERVER’ and ‘TCP CLIENT’ is completed. If there is no response from Peer
against of transmitted SYN Packet within the Retransmission Time, Sn_IR
[TIMEOUT] is set to ‘1’.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="others-flow"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#others-flow" title="Direct link to heading">#</a>Others flow</h4><p>Refer to &quot;TCP SERVER&quot; flow.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/docs/Product/iEthernet/W5100S/Application Note/TCP.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/Product/iEthernet/W5100S/comparison_sheet"><div class="pagination-nav__link--sublabel">Previous</div><div class="pagination-nav__link--label">« Comparison Sheet</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/Product/iEthernet/W5100S/Application Note/udp"><div class="pagination-nav__link--sublabel">Next</div><div class="pagination-nav__link--label">UDP »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#content" class="contents__link">Content</a></li><li><a href="#initialization" class="contents__link">Initialization</a><ul><li><a href="#basic-setting" class="contents__link">Basic Setting</a></li><li><a href="#setting-network-information" class="contents__link">Setting Network Information</a></li><li><a href="#set-socket-n-buffer-information" class="contents__link">Set SOCKET n Buffer Information</a></li></ul></li><li><a href="#data-communications" class="contents__link">Data Communications</a><ul><li><a href="#tcp" class="contents__link">TCP</a></li><li><a href="#tcp-server" class="contents__link">TCP SERVER</a></li><li><a href="#tcp-client" class="contents__link">TCP CLIENT</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/doc1">Style Guide</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://stackoverflow.com/questions/tagged/docusaurus">Stack Overflow</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://discordapp.com/invite/docusaurus">Discord</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Social</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://github.com/facebook/docusaurus">GitHub</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://twitter.com/docusaurus">Twitter</a></li></ul></div></div><div class="text--center"><div>Copyright © 2020 My Project, Inc. Built with Docusaurus.</div></div></div></footer>
</div>

<script src="/styles.fe9632ff.js"></script>

<script src="/runtime~main.1aae1744.js"></script>

<script src="/main.8be1d49d.js"></script>

<script src="/1.c2b11969.js"></script>

<script src="/2.08249d2f.js"></script>

<script src="/3.30edc262.js"></script>

<script src="/1be78505.a940f782.js"></script>

<script src="/20ac7829.bee19571.js"></script>

<script src="/17896441.75384c65.js"></script>

<script src="/80a3db3f.22f01d85.js"></script>


</body>
</html>