<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.53">


<title data-react-helmet="true">UDP | My Site</title>

<meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="UDP | My Site"><meta data-react-helmet="true" name="description" content="## Content"><meta data-react-helmet="true" property="og:description" content="## Content"><meta data-react-helmet="true" property="og:url" content="https://Wiznet.github.io/docs/Product/iEthernet/W5100S/Application Note/udp">

<link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico">


<link rel="stylesheet" href="/styles.6da835b6.css">


<link rel="preload" href="/styles.fe9632ff.js" as="script">

<link rel="preload" href="/runtime~main.1aae1744.js" as="script">

<link rel="preload" href="/main.8be1d49d.js" as="script">

<link rel="preload" href="/1.c2b11969.js" as="script">

<link rel="preload" href="/2.08249d2f.js" as="script">

<link rel="preload" href="/3.30edc262.js" as="script">

<link rel="preload" href="/1be78505.a940f782.js" as="script">

<link rel="preload" href="/20ac7829.bee19571.js" as="script">

<link rel="preload" href="/17896441.75384c65.js" as="script">

<link rel="preload" href="/1361130d.e31da89f.js" as="script">

</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/wiznet-logo.svg" alt="My Site Logo"><strong class="navbar__title"></strong></a><a class="navbar__item navbar__link" href="/docs/introduction">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a target="_blank" rel="noopener noreferrer" href="https://github.com/facebook/docusaurus" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/wiznet-logo.svg" alt="My Site Logo"><strong class="navbar__title"></strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" position="left" href="/docs/introduction">Docs</a></li><li class="menu__list-item"><a class="menu__link" position="left" href="/blog">Blog</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="https://github.com/facebook/docusaurus" class="menu__link" position="right">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">WIZnet Document Wiki</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/introduction">Introduction</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Products</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/products">Products</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Pre-programmed MCU</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/Pre-programmed MCU/pre_programmed_mcu">Pre-programmed MCU</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">W7500P</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/Pre-programmed MCU/W7500P-S2E/w7500p-s2e-[KO]">W7500(P)-S2E</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/Pre-programmed MCU/W7500P-S2E/w7500p-s2e-[EN]">W7500P-S2E</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">iEthernet</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/iEthernet/iethernet">iEthernet</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">W6100</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W6100/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W6100/document">Document</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W6100/driver_basic_project">Driver &amp; Basic Project</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W6100/ref_schematic">Ref. Schematic</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W6100/application_note">Application Note</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W6100/w6100_evb">W6100-EVB</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">W5100S</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/iEthernet/W5100S/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/iEthernet/W5100S/document">Document</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/iEthernet/W5100S/driver">Driver</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/iEthernet/W5100S/ref_schematic">Ref. Schematic</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/iEthernet/W5100S/comparison_sheet">Comparison Sheet</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Application Note</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/iEthernet/W5100S/Application Note/tcp">TCP</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" tabindex="0" href="/docs/Product/iEthernet/W5100S/Application Note/udp">UDP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/iEthernet/W5100S/Application Note/ipraw">IPRAW</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/iEthernet/W5100S/Application Note/pppoe">PPPoE</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/iEthernet/W5100S/Application Note/socket_less_command">SOCKET-less Command</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/iEthernet/W5100S/Application Note/interrupt">Interrupt</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/iEthernet/W5100S/Application Note/dma">DMA</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/iEthernet/W5100S/all_pages">All Pages</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Product/iEthernet/W5100S/w5100s_evb">W5100S-EVB</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">W5500</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W5500/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W5500/datasheet">Datasheet</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W5500/ref_schematic">Ref. Schematic</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Application</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W5500/Application/tcp">TCP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W5500/Application/udp">UDP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W5500/Application/ipraw">IPRAW</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W5500/Application/pppoe">PPPoE</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W5500/Application/spi_performance">SPI Performance</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W5500/esd_test_document">ESD Test Document</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W5500/all_pages">All Pages</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">W5500-EVB</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W5500/W5500-EVB/w5500_evb">W5500-EVB</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W5500/W5500-EVB/getting_started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/iEthernet/W5500/W5500-EVB/make_new_projects">Make New Projects</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link" to="http://www.wiznet.io/product-item/w5300/" target="_blank" rel="noreferrer noopener" tabindex="0" href="http://www.wiznet.io/product-item/w5300/">W5300(Link)</a></li><li class="menu__list-item"><a class="menu__link" to="https://www.wiznet.io/product-item/w5100/" target="_blank" rel="noreferrer noopener" tabindex="0" href="https://www.wiznet.io/product-item/w5100/">W5100(Link)</a></li><li class="menu__list-item"><a class="menu__link" to="https://www.wiznet.io/product-item/w3150a+/" target="_blank" rel="noreferrer noopener" tabindex="0" href="https://www.wiznet.io/product-item/w3150a+/">W3150A+(Link)</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">ioModule</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/iomodule">ioModule</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">WIZ610io</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/WIZ610io/wiz610io">WIZ610io</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">WIZ610MJ</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/WIZ610MJ/wiz610mj">WIZ610MJ</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">WIZ810Sio</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/WIZ810Sio/wiz810sio">WIZ810Sio</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">WIZ810SMJ</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/WIZ810SMJ/wiz810smj">WIZ810SMJ</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">WIZ850io</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/WIZ850io/wiz850io">WIZ850io</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">WIZ550io</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/WIZ550io/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/WIZ550io/hardware_pins">Hardware Pins</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/WIZ550io/characteristic">Characteristic</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/WIZ550io/spi_operations">SPI Operations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/WIZ550io/timing_diagram">Timing Diagram</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/WIZ550io/block_diagram_schematic">Block Diagram &amp; Schematic</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/WIZ550io/dimension">Dimension</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/WIZ550io/related_products">Related Products</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/ioModule/WIZ550io/all_pages">All Pages</a></li></ul></li><li class="menu__list-item"><a class="menu__link" to="http://www.wiznet.io/product-item/wiz820io/" target="_blank" rel="noreferrer noopener" tabindex="-1" href="http://www.wiznet.io/product-item/wiz820io/">WIZ820io(Link)</a></li><li class="menu__list-item"><a class="menu__link" to="https://www.wiznet.io/product-item/wiz810mj/" target="_blank" rel="noreferrer noopener" tabindex="-1" href="https://www.wiznet.io/product-item/wiz810mj/">WIZ810MJ(Link)</a></li><li class="menu__list-item"><a class="menu__link" to="https://www.wiznet.io/product-item/wiz811mj/" target="_blank" rel="noreferrer noopener" tabindex="-1" href="https://www.wiznet.io/product-item/wiz811mj/">WIZ811MJ(Link)</a></li><li class="menu__list-item"><a class="menu__link" to="http://www.wiznet.io/product-item/wiz812mj/" target="_blank" rel="noreferrer noopener" tabindex="-1" href="http://www.wiznet.io/product-item/wiz812mj/">WIZ812MJ(Link)</a></li><li class="menu__list-item"><a class="menu__link" to="https://www.wiznet.io/product-item/wiz830mj/" target="_blank" rel="noreferrer noopener" tabindex="-1" href="https://www.wiznet.io/product-item/wiz830mj/">WIZ830MJ(Link)</a></li><li class="menu__list-item"><a class="menu__link" to="https://www.wiznet.io/product-item/nm7010b+/" target="_blank" rel="noreferrer noopener" tabindex="-1" href="https://www.wiznet.io/product-item/nm7010b+/">NM7010B+(Link)</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">App Module</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/App Module/app_module">App Module</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">WIZ550web</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/App Module/WIZ550web/wiz550web">WIZ550web</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/App Module/WIZ550web/datasheet_kor">Datasheet(Kor)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/App Module/WIZ550web/datasheet_eng">Datasheet(Eng)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/App Module/WIZ550web/getting_started_guide_kor">Getting Started Guide(Kor)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/App Module/WIZ550web/getting_started_guide_eng">Getting Started Guide(Eng)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/App Module/WIZ550web/future_plan_kor">Future Plan(Kor)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/App Module/WIZ550web/future_plan_eng">Future Plan(Eng)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/App Module/WIZ550web/tutorials_kor">Tutorials(Kor)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/App Module/WIZ550web/tutorials_eng">Tutorials(Eng)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/App Module/WIZ550web/download">Download</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Open Source Hardware</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/Open Source Hardware/open_source_hardware">Open Source Hardware</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/Open Source Hardware/w5100s_mkr_ethernet_shield">W5100S (MKR-)Ethernet Shield</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/Open Source Hardware/w6100_mkr_ethernet_shield">W6100 (MKR-)Ethernet Shield</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/Open Source Hardware/wizarduino_m0_eth">WizArduino M0 ETH</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/Open Source Hardware/wizarduino_mega_wifi">WizArduino MEGA WIFI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/Open Source Hardware/wizfi310_shield">WizFi310 Shield</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/Open Source Hardware/w5500_ethernet_shield">W5500 Ethernet Shield</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/Open Source Hardware/ioshield_a">ioShield-A</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/Open Source Hardware/ioshield_k">ioShield-K</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Product/Open Source Hardware/ioshield_l">ioShield-L</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Design_Guide</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Design Guide/design_guide">Design Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Design Guide/hardware_design_guide">Hardware Design Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Design Guide/package_information">Package Information</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Design Guide/ir_reflow_profile">IR Reflow Profile</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Design Guide/eagle_cad_library_of_wiznet_products">Eagle CAD Library of WIZnet Products</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">VAR_Products_using_WIZnet</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/VAR Products using WIZnet/ethernet_shield">Ethernet Shield</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/VAR Products using WIZnet/wi_fi_shield">Wi-Fi Shield</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/VAR Products using WIZnet/third_party">Third party</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="container padding-vert--lg docItemWrapper_1cc7"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">UDP</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="content"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#content" title="Direct link to heading">#</a>Content</h2><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="w5100s-udp-function"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#w5100s-udp-function" title="Direct link to heading">#</a>W5100S UDP Function</h1><p>By setting some register and memory operation, W5100S provides internet
connectivity. This chapter describes how it can be operated.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="initialization"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#initialization" title="Direct link to heading">#</a>Initialization</h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="basic-setting"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#basic-setting" title="Direct link to heading">#</a>Basic Setting</h3><p>For the W5100S operation, select and utilize appropriate registers shown
below.</p><ol><li>Mode Register (MR)</li><li>Interrupt Mask Register (IMR)</li><li>Retry Time-value Register (RTR)</li><li>Retry Count Register (RCR)</li></ol><p>For more information of above registers, refer to the “Register
Descriptions.”</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="setting-network-information"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#setting-network-information" title="Direct link to heading">#</a>Setting network information</h3><p>Basic network information setting for communication: It must be set the
basic network information.</p><ol><li>SHAR(Source Hardware Address Register)<ul><li>It is prescribed that the source hardware addresses, which is
set by SHAR, use unique hardware addresses (Ethernet MAC
address) in the Ethernet MAC layer. The IEEE manages the MAC
address allocation. The manufacturer which produces the network
device allocates the MAC address to product.</li><li>Details on MAC address allocation refer to the website as below.</li><li><a href="http://www.ieee.org/">http://www.ieee.org/</a></li><li><a href="http://standards.ieee.org/regauth/oui/index.shtml">http://standards.ieee.org/regauth/oui/index.shtml</a></li></ul></li><li>GAR(Gateway Address Register)</li><li>SUBR(Subnet Mask Register)</li><li>SIPR(Source IP Address Register)</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="set-socket-memory-information"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#set-socket-memory-information" title="Direct link to heading">#</a>Set SOCKET memory information</h3><p>This stage sets the socket TX/RX memory information. The base address
and mask address of each SOCKET are fixed and saved in this stage.</p><div>*In case of, assign 2Kbytes TX/RX memory per SOCKET*</div><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">In </span><span class="token keyword" style="font-style:italic">case</span><span class="token plain"> of</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> assign </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain">Kbytes TX</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">RX memory per SOCKET</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">Sn_RXMEM_SIZE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">ch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint8 </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Assign 2K rx memory per SOCKET</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">Sn_TXMEM_SIZE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">ch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">uint8 </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Assign 2K rx memory per SOCKET</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* Same method, set gS1_TX_BASE, gS1_TX_MASK, gS2_TX_BASE, gS2_TX_MASK,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">gS3_TX_BASE, gS3_TX_MASK, gS4_TX_BASE, gS4_TX_MASK*/</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="data-communications"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#data-communications" title="Direct link to heading">#</a>Data Communications</h2><p>After the initialization process, W5100S can transmit and receive the
data with others by ‘open’ the SOCKET of TCP, UDP, IPRAW, and MACRAW
mode. The W5100S supports the independently and simultaneously usable 4
SOCKETs. In this section, the communication method for each mode will be
introduced.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="udp"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#udp" title="Direct link to heading">#</a>UDP</h3><p>The UDP is a Connection-less protocol. It communicates without
“connection SOCKET”. The TCP protocol guarantees reliable data
communication, but the UDP protocol uses datagram communication which
has no guarantees of data communication. Because the UDP does not use
“connection SOCKET”, it can communicate with many other devices with
the known host IP address and port number. This is a great advantage,
communication with many others by using just one SOCKET. But also it has
many problems such as loss of transmitted data, unwanted data received
from others, etc. To avoid these problems and guarantee reliability, the
host retransmits damaged data or ignores the unwanted data which is
received from others. The UDP protocol supports unicast, broadcast, and
multicast communication. It follows the below communication flow.</p><p><img src="/products/w5500/application/udp_flow.jpg" alt="UDP Operation Flow"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="unicast-and-broadcast"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#unicast-and-broadcast" title="Direct link to heading">#</a>Unicast and Broadcast</h3><p>The unicast is one method of UDP communication. It transmits data to one
destination at one time. On the other hand, the broadcast communication
transmits data to all receivable destinations by using ‘broadcast IP
address (255.255.255.255)’. For example, suppose that the user transmits
data to destination A, B, and C. The unicast communication transmits
each destination A, B, and C at each time. At this time, the
ARP<sub>TO</sub> can also occur when the user gets the destination
hardware address of destinations A, B and C. User cannot transmit data
to destinations which have ARP<sub>TO</sub>. The broadcast communication
can simultaneously transmit data to destination A, B and C at one time
by using “255.255.255.255” or “local address | (~subnet address)” IP
address. At this time, there is no need to get the destination hardware
address about destination A, B and C, and also ARP<sub>TO</sub>is not
occurred.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="note-broadcast-ip"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#note-broadcast-ip" title="Direct link to heading">#</a>Note: Broadcast IP</h5><p>\=&gt; The Broadcast IP address can be obtained by performing a bit-wise
logical OR operation between the bit complement of the subnet mask and
the host’s IP address.<br>
ex&gt; If IP:”222.98.173.123” and the subnet mask:“255.255.255.0”,
broadcast IP is “222.98.173.255”</p><table><thead><tr><th>Description</th><th>Decimal</th><th>Binary</th></tr></thead><tbody><tr><td>HOST IP</td><td>222.098.173.123</td><td>11011110.01100010.10101101.01111011</td></tr><tr><td>Bit Complement Subnet mask</td><td>000.000.000.255</td><td>00000000.00000000.00000000.11111111</td></tr><tr><td>Bitwise OR</td><td>-</td><td>-</td></tr><tr><td>Broadcast IP</td><td>222.098.173.255</td><td>11011110.01100010.10101101.11111111</td></tr></tbody></table><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="socket-initialization"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#socket-initialization" title="Direct link to heading">#</a>SOCKET Initialization</h5><p>For the UDP data communication, SOCKET initialization is required; it
opens the SOCKET. The SOCKET open process is as followed. At first,
choose one SOCKET among the 4 SOCKETS of W5100S, then set the protocol
mode (Sn_MR(P3:P0)) of the chosen SOCKET and set the source port number
Sn_PORT0 for communication. Finally, execute the OPEN command. After
the OPEN command, the state of Sn_SR is changed to SOCK_UDP. Then the
SOCKET initialization is complete.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">START</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Sn_MR </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x02</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* sets UDP mode */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Sn_PORT0 </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> source_port</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* sets source port number */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Sn_CR </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> OPEN</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* sets OPEN command */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* wait until Sn_SR is changed to SOCK_UDP */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_SR </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> SOCK_UDP</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> Sn_CR </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> CLOSE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> START</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="check-received-data"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#check-received-data" title="Direct link to heading">#</a>Check received data</h5><p>Check the reception of UDP data from destination. User can also check
for received data via TCP communication. It is strongly recommended to
use the second method because of the same reasoning from TCP. Please
refer to the “TCP SERVER” section. <a href="http://wizwiki.net/wiki/doku.php?id=products:W5100S:application:tcp_function">TCP
SERVER</a></p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">First method </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">RECV</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">RECV</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> Receiving Process stage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* In this case, if the interrupt of Socket n is activated, interrupt occurs. Refer to IR, IMR</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">Sn_IMR and Sn_IR. */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Second Method </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_RX_RSR0 </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x0000</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> Receiving Process stage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="receiving-process"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#receiving-process" title="Direct link to heading">#</a>Receiving process</h5><p>Process the received UDP data in Internal RX memory.<br>
The structure of received UDP data is as below.</p><p><img src="/products/w5500/application/received_udp_data.jpg" alt="The Received UDP data
format"></p><p>The received UDP data consists of 8bytes PACKET-INFO, and DATA packet.
The PACKET-INFO contains transmitter’s information (IP address, Port
number) and the length of DATA packet. The UDP can receive UDP data from
many others. User can classify the transmitter by transmitter’s
information of PACKET-INFO. It also receives broadcast SOCKET by using
“255.255.255.255” IP address. So the host should ignore unwanted
reception by analysis of transmitter’s information. If the DATA size of
SOCKET n is larger than Internal RX memory free size, user cannot
receive that DATA and also cannot receive fragmented DATA.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* Get offset address */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">src_ptr </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> Sn_RX_RD</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* select RX memory, refer to RMSR(Rx Memory Size Register) */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cntl_byte </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> Socket_n_RX_Buffer </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* read head information (8 bytes) */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">header_size </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">8</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* copy header_size bytes of get_start_address to header_address */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">for</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">i</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> i</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">header_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> i</span><span class="token operator" style="color:rgb(137, 221, 255)">++</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  header</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">W5100S_READ</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">src_ptr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> header</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* update src_ptr */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">src_ptr </span><span class="token operator" style="color:rgb(137, 221, 255)">+=</span><span class="token plain"> header_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* save remote peer information &amp; received data size */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">peer_ip </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> header</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"> to </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">peer_port </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> header</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token plain"> to </span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">get_size </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> header</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token plain"> to </span><span class="token number" style="color:rgb(247, 140, 108)">7</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* copy len bytes of src_ptr to destination_address */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">for</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">i</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> i</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">get_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> i</span><span class="token operator" style="color:rgb(137, 221, 255)">++</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">dst_ptr</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">W5100S_READ</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">addr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> cntl_byte</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> src_ptr</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* increase Sn_RX_RD as length of len+ header_size */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Sn_RX_RD </span><span class="token operator" style="color:rgb(137, 221, 255)">+=</span><span class="token plain"> get_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* set RECV command */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Sn_CR </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> RECV</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="check-send-data--sending-process"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#check-send-data--sending-process" title="Direct link to heading">#</a>Check send data / sending process</h5><p>The size of DATA that the user wants to transmit cannot be larger than
Internal TX memory. If it is larger than MTU, it is automatically
divided by MTU unit and transmitted. The Sn_DIPR0 is set
“255.255.255.255” when user wants to broadcast.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* first, get the free TX memory size */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">FREESIZE</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">freesize </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> Sn_TX_FSR0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">freesize</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">len</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> FREESIZE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// len is send size</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* Write the value of remote_ip, remote_port to the Socket n Destination IP Address</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">Register(Sn_DIPR), Socket n Destination Port Register(Sn_DPORT). */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Sn_DIPR0 </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> remote_ip</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Sn_DPORT0 </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> remote_port</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* Get offset address */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">dst_ptr </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> Sn_TX_WR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* select TX memory, refer to TMSR(Tx Memory Size Register) */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cntl_byte </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> Socket_n_TX_Buffer </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* copy len bytes of source_address to dst_ptr */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">for</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">i</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> i</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">len</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> i</span><span class="token operator" style="color:rgb(137, 221, 255)">++</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">W5100S_WRITE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">addr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> cntl_byte</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> dst_ptr</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* increase Sn_TX_WR0 as length of len */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Sn_TX_WR </span><span class="token operator" style="color:rgb(137, 221, 255)">+=</span><span class="token plain"> len</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* set SEND command */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Sn_CR </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> SEND</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="check-complete-sending--timeout"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#check-complete-sending--timeout" title="Direct link to heading">#</a>Check complete sending / Timeout</h5><p>To transmit the next data, user must check that the prior SEND command
is completed. The larger the data size, the more time to complete the
SEND command. Therefore, the user must properly divide the data to
transmit. The ARP<sub>TO</sub> can occur when user transmits UDP data.
If ARP<sub>TO</sub> occurs, the UDP data transmission has failed.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">First method </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* check SEND command completion */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">while</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">SENDOK</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain">‘</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* wait interrupt of SEND completion */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* check ARPTO */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">TIMEOUT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain">‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">TIMEOUT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> Next stage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">SENDOK</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* clear previous interrupt of SEND completion */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Second method </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">If</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_CR </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x00</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> transmission is completed</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">If</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">Sn_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">TIMEOUT bit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> next stage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* In this case, if the interrupt of Socket n is activated, interrupt occurs. Refer to</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">Interrupt Register(IR), Interrupt Mask Register (IMR) and Socket n Interrupt Register (Sn_IR).</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">*/</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="check-finished--socket-close"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#check-finished--socket-close" title="Direct link to heading">#</a>Check Finished / SOCKET close</h4><p>If user doesn’t need the communication any more, close the SOCKET n.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* clear remained interrupts */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Sn_IR </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x00FF</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* set CLOSE command */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Sn_CR </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> CLOSE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="multicast"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#multicast" title="Direct link to heading">#</a>Multicast</h3><p>The broadcast communication communicates with many and unspecified
others. But the multicast communication communicates with many specified
others who registered at a multicast-group. Suppose that A, B, and C are
registered at a specified multicast-group. If user transmits data to
multicast-group (contains A), B and C also receive the DATA for A. To
use multicast communication, the destination list registers to
multicast-group by using IGMP protocol. The multicast-group consists of
‘Group hardware address,’ ‘Group IP address,’ and ‘Group port number.’
User cannot change the ‘Group hardware address’ and ‘Group IP address.’
But the ‘Group port number’ can be changed.<br>
The ‘Group hardware address’ is selected at the assigned range (From
“01:00:5e:00:00:00”to “01:00:5e:7f:ff:ff”) and the ‘Group IP address’
is selected in D-class IP address (From “224.0.0.0” to
“239.255.255.255”, please refer to the website;
<a href="http://www.iana.org/assignments/multicast-addresses">http://www.iana.org/assignments/multicast-addresses</a>).<br>
When selecting, the upper 23bits of 6bytes ‘Group hardware address’ and
the 4bytes ‘Group IP address’ must be the same. For example, if the user
selects the ‘Group IP address’ to “244.1.1.11,” the ‘Group hardware
address’ is selected to “01:00:5e:01:01:0b.” Please refer to the
“RFC1112” (<a href="http://www.ietf.org/rfc.html">http://www.ietf.org/rfc.html</a>).<br>
In the W5100S, IGMP processing to register the multicast-group is
internally (automatically) processed. When the user opens the SOCKET n
with multicast mode, the “Join” message is internally transmitted. If
the user closes it, the “Leave” message is internally transmitted. After
the SOCKET opens, the “Report” message is periodically and internally
transmitted when the user communicates.<br>
The W5100S support IGMP version 1 and version 2 only. If user wants use
an updated version, the host processes IGMP directly by using the IPRAW
mode SOCKET.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="socket-initialization-1"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#socket-initialization-1" title="Direct link to heading">#</a>SOCKET Initialization</h5><p>Choose one SOCKET for multicast communication among 4 SOCKETs of W5100S.
Set the Sn_DHAR0 to ‘Multicast-group hardware address’ and set the
Sn_DIPR0 to ‘Multicastgroup IP address.’ Then set the Sn_PORT0 and
Sn_DPORT0 to ‘Multicast-group port number.’ Set the Sn_MR(P3:P0) to
UDP and set the Sn_MR(MULTI) to ‘1.’ Finally, execute OPEN command. If
the state of Sn_SR is changed to SOCK_UDP after the OPEN command, the
SOCKET initialization is completed.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">START</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* set Multicast-Group information */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* set Multicast-Group H/W address(01:00:5e:01:01:0b) */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Sn_DHAR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token number" style="color:rgb(247, 140, 108)">0x01</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token number" style="color:rgb(247, 140, 108)">0x00</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token number" style="color:rgb(247, 140, 108)">0x5e</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token number" style="color:rgb(247, 140, 108)">0x01</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token number" style="color:rgb(247, 140, 108)">0x01</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token number" style="color:rgb(247, 140, 108)">0x0b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* set Multicast-Group IP address(211.1.1.11) */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Sn_DIPR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token number" style="color:rgb(247, 140, 108)">211</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token number" style="color:rgb(247, 140, 108)">11</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Sn_DPORT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token number" style="color:rgb(247, 140, 108)">0x0B</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token number" style="color:rgb(247, 140, 108)">0xB8</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* set Multicast-GroupPort number(3000) */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Sn_PORT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token number" style="color:rgb(247, 140, 108)">0x0B</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token number" style="color:rgb(247, 140, 108)">0xB8</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* set SourcePort number(3000) */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Sn_MR </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x02</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x80</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* set UDP mode &amp; Multicast on Socket n Mode Register */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Sn_CR </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> OPEN</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* set OPEN command */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* wait until Sn_SR is changed to SOCK_UDP */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Sn_SR </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> SOCK_UDP</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> Sn_CR </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> CLOSE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> START</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="check-received-data-1"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#check-received-data-1" title="Direct link to heading">#</a>Check received data</h5><p>Refer to the “Unicast &amp; Broadcast.” section.</p><p><a href="http://wizwiki.net/wiki/doku.php?id=products:w5100s:application:udp_function#unicast_and_broadcast">Unicast &amp;
Broadcast</a></p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="receiving-process-1"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#receiving-process-1" title="Direct link to heading">#</a>Receiving process</h5><p>Refer to the “Unicast &amp; Broadcast.” section. <a href="http://wizwiki.net/wiki/doku.php?id=products:w5100s:application:udp_function#unicast_and_broadcast">Unicast &amp;
Broadcast</a></p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="check-send-data--sending-process-1"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#check-send-data--sending-process-1" title="Direct link to heading">#</a>Check send data / Sending Process</h5><p>Since the user sets the information about multicast-group at SOCKET
initialization, user does not need to set IP address and port number for
destination any more. Therefore, copy the transmission data to internal
TX memory and executes SEND command.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* first, get the free TX memory size */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">FREESIZE</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">freesize </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> Sn_TX_FSR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">freesize</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">len</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">goto</span><span class="token plain"> FREESIZE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// len is send size</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* calculate offset address */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">dst_mask </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> Sn_TX_WR0 </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">gSn_TX_MASK</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// dst_mask is offset address</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* calculate start address(physical address) */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">dst_ptr </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> gSn_TX_BASE </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> dst_mask</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// dst_ptr is physical start address</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* if overflow SOCKETTX memory */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">dst_mask </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> len</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">gSn_TX_MASK </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* copy upper_size bytes of source_addr to destination_address */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">upper_size </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">gSn_TX_MASK </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token plain"> dst_mask</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">memcpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0x0000</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> source_addr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0x0000</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> dst_ptr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> upper_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* update source_addr*/</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">source_addr </span><span class="token operator" style="color:rgb(137, 221, 255)">+=</span><span class="token plain"> upper_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* copy left_size bytes of source_addr to gSn_TX_BASE */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">left_size </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> len </span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token plain"> upper_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">memcpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"> source_addr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> gSn_TX_BASE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> left_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">else</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* copy len bytes of source_addr to dst_ptr */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">memcpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"> source_addr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> dst_ptr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> len</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* increase Sn_TX_WR as length of len */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Sn_TX_WR0 </span><span class="token operator" style="color:rgb(137, 221, 255)">+=</span><span class="token plain"> send_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* set SEND command */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Sn_CR </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> SEND</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="check-complete-sending--timeout-1"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#check-complete-sending--timeout-1" title="Direct link to heading">#</a>Check complete sending / Timeout</h5><p>Since the host manages all protocol process for data communication,
timeout cannot occur.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-c codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* check SEND command completion */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">while</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">S0_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">SENDOK</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain">‘</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* wait interrupt of SEND completion */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">S0_IR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">SENDOK</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ‘</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">’</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* clear previous interrupt of SEND completion */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="check-finished--socket-close-1"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#check-finished--socket-close-1" title="Direct link to heading">#</a>Check finished / SOCKET close</h5><p>Refer to the “Unicast &amp; Broadcast.” section. <a href="http://wizwiki.net/wiki/doku.php?id=products:w5100s:application:udp_function#unicast_and_broadcast">Unicast &amp;
Broadcast</a></p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/docs/Product/iEthernet/W5100S/Application Note/UDP.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/Product/iEthernet/W5100S/Application Note/tcp"><div class="pagination-nav__link--sublabel">Previous</div><div class="pagination-nav__link--label">« TCP</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/Product/iEthernet/W5100S/Application Note/ipraw"><div class="pagination-nav__link--sublabel">Next</div><div class="pagination-nav__link--label">IPRAW »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#content" class="contents__link">Content</a></li><li><a href="#initialization" class="contents__link">Initialization</a><ul><li><a href="#basic-setting" class="contents__link">Basic Setting</a></li><li><a href="#setting-network-information" class="contents__link">Setting network information</a></li><li><a href="#set-socket-memory-information" class="contents__link">Set SOCKET memory information</a></li></ul></li><li><a href="#data-communications" class="contents__link">Data Communications</a><ul><li><a href="#udp" class="contents__link">UDP</a></li><li><a href="#unicast-and-broadcast" class="contents__link">Unicast and Broadcast</a></li><li><a href="#multicast" class="contents__link">Multicast</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/doc1">Style Guide</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://stackoverflow.com/questions/tagged/docusaurus">Stack Overflow</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://discordapp.com/invite/docusaurus">Discord</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Social</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://github.com/facebook/docusaurus">GitHub</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://twitter.com/docusaurus">Twitter</a></li></ul></div></div><div class="text--center"><div>Copyright © 2020 My Project, Inc. Built with Docusaurus.</div></div></div></footer>
</div>

<script src="/styles.fe9632ff.js"></script>

<script src="/runtime~main.1aae1744.js"></script>

<script src="/main.8be1d49d.js"></script>

<script src="/1.c2b11969.js"></script>

<script src="/2.08249d2f.js"></script>

<script src="/3.30edc262.js"></script>

<script src="/1be78505.a940f782.js"></script>

<script src="/20ac7829.bee19571.js"></script>

<script src="/17896441.75384c65.js"></script>

<script src="/1361130d.e31da89f.js"></script>


</body>
</html>